<!-- HTML extra√≠do de register.component.js -->
<div class="auth-component register-component">
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-logo">üèùÔ∏è</div>
                <h2>Crear Cuenta</h2>
                <p class="auth-subtitle">√önete a la Econom√≠a Circular de Canarias</p>
            </div>
            <form id="registerForm" class="auth-form">
                <!-- Informaci√≥n Personal -->
                <div class="form-section">
                    <h3 class="section-title"><span class="section-icon">üë§</span>Informaci√≥n Personal</h3>
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="registerFirstName" class="form-label"><span class="label-icon">üë§</span>Nombre</label>
                            <div class="input-container">
                                <input type="text" id="registerFirstName" name="firstName" required class="form-input" placeholder="Tu nombre" autocomplete="given-name">
                            </div>
                            <span class="form-error" id="firstNameError"></span>
                        </div>
                        <div class="form-group half">
                            <label for="registerLastName" class="form-label"><span class="label-icon">üë§</span>Apellidos</label>
                            <div class="input-container">
                                <input type="text" id="registerLastName" name="lastName" required class="form-input" placeholder="Tus apellidos" autocomplete="family-name">
                            </div>
                            <span class="form-error" id="lastNameError"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail" class="form-label"><span class="label-icon">üìß</span>Correo Electr√≥nico</label>
                        <div class="input-container">
                            <input type="email" id="registerEmail" name="email" required class="form-input" placeholder="tu@email.com" autocomplete="email">
                        </div>
                        <span class="form-error" id="emailError"></span>
                    </div>
                    <div class="form-group">
                        <label for="registerPhone" class="form-label"><span class="label-icon">üì±</span>Tel√©fono</label>
                        <div class="input-container">
                            <input type="tel" id="registerPhone" name="phone" class="form-input" placeholder="+34 XXX XXX XXX" autocomplete="tel">
                        </div>
                        <span class="form-error" id="phoneError"></span>
                    </div>
                    <!-- Imagen de Perfil -->
                    <div class="form-group">
                        <label for="registerProfileImage" class="form-label"><span class="label-icon">üì∏</span>Imagen de Perfil (Opcional)</label>
                        <div class="image-upload-container">
                            <div class="image-preview" id="imagePreview">
                                <div class="preview-placeholder">
                                    <span class="preview-icon">üë§</span>
                                    <span class="preview-text">Subir foto</span>
                                </div>
                            </div>
                            <input type="file" id="registerProfileImage" name="profileImage" accept="image/*" class="form-input-file" style="display: none;">
                            <button type="button" class="btn-upload" onclick="document.getElementById('registerProfileImage').click()">
                                <span class="upload-icon">üìÅ</span>
                                Seleccionar Imagen
                            </button>
                            <div class="upload-info">
                                <small>Formatos: JPG, PNG, GIF, WebP. M√°ximo: 5MB</small>
                            </div>
                        </div>
                        <span class="form-error" id="profileImageError"></span>
                    </div>
                </div>
                <!-- Ubicaci√≥n -->
                <div class="form-section">
                    <h3 class="section-title"><span class="section-icon">üèùÔ∏è</span>Ubicaci√≥n en Canarias</h3>
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="registerIsland" class="form-label"><span class="label-icon">üèùÔ∏è</span>Isla</label>
                            <div class="input-container">
                                <select id="registerIsland" name="island" required class="form-input form-select">
                                    <option value="">Selecciona tu isla</option>
                                    <option value="gran-canaria">Gran Canaria</option>
                                    <option value="tenerife">Tenerife</option>
                                    <option value="lanzarote">Lanzarote</option>
                                    <option value="fuerteventura">Fuerteventura</option>
                                    <option value="la-palma">La Palma</option>
                                    <option value="la-gomera">La Gomera</option>
                                    <option value="el-hierro">El Hierro</option>
                                </select>
                            </div>
                            <span class="form-error" id="islandError"></span>
                        </div>
                        <div class="form-group half">
                            <label for="registerCity" class="form-label"><span class="label-icon">üèòÔ∏è</span>Municipio</label>
                            <div class="input-container">
                                <input type="text" id="registerCity" name="city" class="form-input" placeholder="Tu municipio" autocomplete="address-level2">
                            </div>
                            <span class="form-error" id="cityError"></span>
                        </div>
                    </div>
                </div>
                <!-- Tipo de Usuario -->
                <div class="form-section">
                    <h3 class="section-title"><span class="section-icon">üéØ</span>¬øC√≥mo participas en la Econom√≠a Circular?</h3>
                    <div class="form-group">
                        <label class="form-label"><span class="label-icon">üë•</span>Tipo de Usuario</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="userType" value="particular" required>
                                <span class="radio-mark"></span>
                                <span class="radio-content"><strong>ÔøΩ Particular</strong><small>Busco productos locales y sostenibles</small></span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="userType" value="empresa" required>
                                <span class="radio-mark"></span>
                                <span class="radio-content"><strong>ÔøΩ Empresa</strong><small>Negocio comprometido con la sostenibilidad</small></span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="userType" value="organizacion" required>
                                <span class="radio-mark"></span>
                                <span class="radio-content"><strong>üå± Organizaci√≥n</strong><small>ONG o asociaci√≥n ambiental</small></span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="userType" value="cooperativa" required>
                                <span class="radio-mark"></span>
                                <span class="radio-content"><strong>ü§ù Cooperativa</strong><small>Cooperativa de producci√≥n sostenible</small></span>
                            </label>
                        </div>
                        <span class="form-error" id="userTypeError"></span>
                    </div>
                </div>
                <!-- Seguridad -->
                <div class="form-section">
                    <h3 class="section-title"><span class="section-icon">üîí</span>Seguridad</h3>
                    <div class="form-group">
                        <label for="registerPassword" class="form-label"><span class="label-icon">üîí</span>Contrase√±a</label>
                        <div class="input-container password-container">
                            <input type="password" id="registerPassword" name="password" required class="form-input" placeholder="M√≠nimo 8 caracteres" autocomplete="new-password">
                            <button type="button" class="password-toggle" id="toggleRegisterPassword"><span class="eye-icon">üëÅÔ∏è</span></button>
                        </div>
                        <div class="password-strength" id="passwordStrength">
                            <div class="strength-bar"><div class="strength-fill" id="strengthFill"></div></div>
                            <span class="strength-text" id="strengthText">Fortaleza de contrase√±a</span>
                        </div>
                        <span class="form-error" id="passwordError"></span>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword" class="form-label"><span class="label-icon">üîí</span>Confirmar Contrase√±a</label>
                        <div class="input-container password-container">
                            <input type="password" id="confirmPassword" name="confirmPassword" required class="form-input" placeholder="Repite tu contrase√±a" autocomplete="new-password">
                            <button type="button" class="password-toggle" id="toggleConfirmPassword"><span class="eye-icon">üëÅÔ∏è</span></button>
                        </div>
                        <span class="form-error" id="confirmPasswordError"></span>
                    </div>
                </div>
                <!-- T√©rminos y Condiciones -->
                <div class="form-section">
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="acceptTerms" name="acceptTerms" required>
                            <span class="checkmark"></span>
                            <span class="checkbox-text">Acepto los <a href="/terminos" class="auth-link" target="_blank">t√©rminos y condiciones</a> y la <a href="/privacidad" class="auth-link" target="_blank">pol√≠tica de privacidad</a></span>
                        </label>
                        <span class="form-error" id="termsError"></span>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="acceptNewsletter" name="acceptNewsletter">
                            <span class="checkmark"></span>
                            <span class="checkbox-text">Quiero recibir noticias sobre productos locales y eventos de sostenibilidad</span>
                        </label>
                    </div>
                </div>
                <button type="submit" class="btn-auth btn-primary" id="registerBtn">
                    <span class="btn-content"><span class="btn-icon">üéØ</span><span class="btn-text">Crear Cuenta</span></span>
                    <span class="btn-loader"><span class="loader-spin">‚è≥</span>Creando cuenta...</span>
                </button>
            </form>
            <div class="auth-divider"><span>¬øYa tienes cuenta?</span></div>
            <div class="auth-footer">
                <a href="/login" class="btn-auth btn-secondary" data-navigate="/login"><span class="btn-icon">üîê</span>Iniciar Sesi√≥n</a>
            </div>
        </div>
    </div>
</div>
<script>
// Firefox First Password Toggle Fix
(function() {
    if (!window.isFirefox) {
        const isFirefox = navigator.userAgent.toLowerCase().includes('firefox');
        window.isFirefox = isFirefox;
        if (isFirefox) {
            // Esperar a que el DOM y el componente est√©n listos
            const checkAndFix = () => {
                const registerPassword = document.getElementById('registerPassword');
                const toggleRegisterPassword = document.getElementById('toggleRegisterPassword');
                if (registerPassword && toggleRegisterPassword) {
                    // Forzar reconfiguraciÔøΩn del toggle
                    const fixPasswordToggle = () => {
                        const passwordField = document.getElementById('registerPassword');
                        const toggleButton = document.getElementById('toggleRegisterPassword');
                        if (passwordField && toggleButton) {
                            // Clonar el elemento para forzar re-render en Firefox
                            const newPasswordField = passwordField.cloneNode(true);
                            passwordField.parentNode.replaceChild(newPasswordField, passwordField);
                            // Reconfigurar el evento del toggle
                            toggleButton.onclick = function(e) {
                                e.preventDefault();
                                const field = document.getElementById('registerPassword');
                                if (field.type === 'password') {
                                    field.type = 'text';
                                    toggleButton.innerHTML = '<span class="show-icon">üôà</span>';
                                    toggleButton.setAttribute('aria-label', 'Ocultar contrase√±a');
                                } else {
                                    field.type = 'password';
                                    toggleButton.innerHTML = '<span class="show-icon">üëÅÔ∏è</span>';
                                    toggleButton.setAttribute('aria-label', 'Mostrar contrase√±a');
                                }
                                // Force Firefox to update
                                field.focus();
                                field.blur();
                            };
                        }
                    };
                    // Aplicar el fix con un peque√±o delay
                    setTimeout(fixPasswordToggle, 100);
                } else {
                    // Reintentar si los elementos no est√°n listos
                    setTimeout(checkAndFix, 100);
                }
            };
            // Iniciar el check
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', checkAndFix);
            } else {
                checkAndFix();
            }
        }
    }
})();
</script>
