<!-- HTML del Componente de Perfil -->
<div class="profile-container">
    <div class="profile-header">
        <div class="profile-avatar" id="profileAvatar">
            <div class="avatar-icon" id="avatarIcon">👤</div>
            <img id="avatarImage" class="avatar-image" style="display: none; width: 80px; height: 80px; object-fit: cover;" alt="Imagen de perfil">
            <div class="avatar-upload" id="avatarUpload" style="display: none;">
                <input type="file" id="profileImageUpload" accept="image/*" style="display: none;">
                <button type="button" class="btn-upload-avatar" onclick="document.getElementById('profileImageUpload').click()">
                    📸 Cambiar Foto
                </button>
            </div>
        </div>
        <div class="profile-info">
            <h1 id="profileUserName">Cargando...</h1>
            <div id="emailVerificationStatus" class="email-status"></div>
        </div>
        <div class="profile-actions">
            <button id="editProfileBtn" class="btn btn-primary">
                <span class="btn-icon">✏️</span>
                Editar Perfil
            </button>
            <button id="saveProfileBtn" class="btn btn-success" style="display: none;">
                <span class="btn-icon">💾</span>
                Guardar Cambios
            </button>
            <button id="cancelEditBtn" class="btn btn-secondary" style="display: none;">
                <span class="btn-icon">❌</span>
                Cancelar
            </button>
        </div>
    </div>
    <div class="profile-content">
        <div class="profile-sections">
            <!-- Información Personal -->
            <div class="profile-section">
                <h2 class="section-title">
                    <span class="section-icon">👤</span>
                    Información Personal
                </h2>
                <form id="profileForm" class="profile-form">
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="profileFirstName" class="form-label">
                                <span class="label-icon">👤</span>
                                Nombre
                            </label>
                            <input type="text" id="profileFirstName" name="firstName" 
                                   class="form-input" disabled required>
                        </div>
                        <div class="form-group half">
                            <label for="profileLastName" class="form-label">
                                <span class="label-icon">👤</span>
                                Apellidos
                            </label>
                            <input type="text" id="profileLastName" name="lastName" 
                                   class="form-input" disabled required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profileEmail" class="form-label">
                            <span class="label-icon">📧</span>
                            Email
                        </label>
                        <input type="email" id="profileEmail" name="email" 
                               class="form-input" disabled readonly>
                        <small class="form-help">El email no se puede cambiar</small>
                    </div>
                    <div class="form-group">
                        <label for="profilePhone" class="form-label">
                            <span class="label-icon">📱</span>
                            Teléfono
                        </label>
                        <input type="tel" id="profilePhone" name="phone" 
                               class="form-input" disabled required 
                               placeholder="Ej: +34 123 456 789">
                    </div>
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="profileIsland" class="form-label">
                                <span class="label-icon">🏝️</span>
                                Isla
                            </label>
                            <select id="profileIsland" name="island" class="form-select" disabled required>
                                <option value="">Selecciona tu isla</option>
                                <option value="Gran Canaria">Gran Canaria</option>
                                <option value="Tenerife">Tenerife</option>
                                <option value="Lanzarote">Lanzarote</option>
                                <option value="Fuerteventura">Fuerteventura</option>
                                <option value="La Palma">La Palma</option>
                                <option value="La Gomera">La Gomera</option>
                                <option value="El Hierro">El Hierro</option>
                            </select>
                        </div>
                        <div class="form-group half">
                            <label for="profileCity" class="form-label">
                                <span class="label-icon">🏙️</span>
                                Ciudad/Municipio
                            </label>
                            <input type="text" id="profileCity" name="city" 
                                   class="form-input" disabled required 
                                   placeholder="Tu ciudad o municipio">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profileUserType" class="form-label">
                            <span class="label-icon">🏢</span>
                            Tipo de Usuario
                        </label>
                        <select id="profileUserType" name="userType" class="form-select" disabled required>
                            <option value="">Selecciona tipo de usuario</option>
                            <option value="particular">Particular</option>
                            <option value="empresa">Empresa</option>
                            <option value="organizacion">Organización</option>
                            <option value="cooperativa">Cooperativa</option>
                        </select>
                    </div>
                </form>
            </div>
            <!-- Seguridad -->
            <div class="profile-section">
                <h2 class="section-title">
                    <span class="section-icon">🔒</span>
                    Seguridad
                </h2>
                <div class="security-options">
                    <div class="security-item">
                        <div class="security-info">
                            <h3>Contraseña</h3>
                            <p>Cambia tu contraseña para mantener tu cuenta segura</p>
                        </div>
                        <button id="changePasswordBtn" class="btn btn-outline-primary">
                            <span class="btn-icon">🔑</span>
                            Cambiar Contraseña
                        </button>
                    </div>
                </div>
            </div>
            <!-- Zona de Peligro -->
            <div class="profile-section danger-section">
                <h2 class="section-title">
                    <span class="section-icon">⚠️</span>
                    Zona de Peligro
                </h2>
                <div class="danger-content">
                    <div class="danger-item">
                        <div class="danger-info">
                            <h3>Eliminar Cuenta</h3>
                            <p>Una vez eliminada, no podrás recuperar tu cuenta ni tus datos. Esta acción es irreversible.</p>
                        </div>
                        <button id="deleteAccountBtn" class="btn btn-danger">
                            <span class="btn-icon">🗑️</span>
                            Eliminar Cuenta
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal de Cambio de Contraseña -->
<div id="changePasswordModal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="modal-icon">🔑</span>
                Cambiar Contraseña
            </h2>
            <button class="modal-close" id="closePasswordModal">&times;</button>
        </div>
        <div class="modal-body">
            <form id="changePasswordForm" class="password-form">
                <div class="form-group">
                    <label for="currentPasswordInput" class="form-label">
                        <span class="label-icon">🔒</span>
                        Contraseña Actual
                    </label>
                    <div class="password-input-container">
                        <input type="password" id="currentPasswordInput" name="currentPassword" 
                               class="form-input" required 
                               placeholder="Ingresa tu contraseña actual">
                        <button type="button" class="password-toggle" data-target="currentPasswordInput">
                            👁️
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="newPasswordInput" class="form-label">
                        <span class="label-icon">🔑</span>
                        Nueva Contraseña
                    </label>
                    <div class="password-input-container">
                        <input type="password" id="newPasswordInput" name="newPassword" 
                               class="form-input" required 
                               placeholder="Mínimo 8 caracteres">
                        <button type="button" class="password-toggle" data-target="newPasswordInput">
                            👁️
                        </button>
                    </div>
                    <div class="password-requirements">
                        <small class="requirement" id="lengthReq">✗ Mínimo 8 caracteres</small>
                        <small class="requirement" id="uppercaseReq">✗ Una letra mayúscula</small>
                        <small class="requirement" id="lowercaseReq">✗ Una letra minúscula</small>
                        <small class="requirement" id="numberReq">✗ Un número</small>
                    </div>
                </div>
                <div class="form-group">
                    <label for="confirmPasswordInput" class="form-label">
                        <span class="label-icon">🔑</span>
                        Confirmar Nueva Contraseña
                    </label>
                    <div class="password-input-container">
                        <input type="password" id="confirmPasswordInput" name="confirmPassword" 
                               class="form-input" required 
                               placeholder="Confirma tu nueva contraseña">
                        <button type="button" class="password-toggle" data-target="confirmPasswordInput">
                            👁️
                        </button>
                    </div>
                    <div id="passwordMatch" class="validation-message" style="display: none;"></div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="cancelPasswordChange">
                <span class="btn-icon">❌</span>
                Cancelar
            </button>
            <button type="submit" class="btn btn-primary" id="submitPasswordChange" form="changePasswordForm">
                <span class="btn-icon">💾</span>
                Cambiar Contraseña
            </button>
        </div>
    </div>
</div>
<!-- Modal de Confirmación de Eliminación -->
<div id="deleteAccountModal" class="modal-overlay" style="display: none;">
    <div class="modal-container delete-modal">
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="modal-icon">⚠️</span>
                Eliminar Cuenta
            </h2>
            <button class="modal-close" id="closeDeleteModal">&times;</button>
        </div>
        <div class="modal-body">
            <div class="warning-content">
                <div class="warning-icon">🚨</div>
                <h3>¿Estás seguro de que quieres eliminar tu cuenta?</h3>
                <p>Esta acción es <strong>irreversible</strong>. Se eliminarán:</p>
                <ul>
                    <li>Tu información personal</li>
                    <li>Historial de pedidos</li>
                    <li>Configuraciones guardadas</li>
                    <li>Todos los datos asociados a tu cuenta</li>
                </ul>
            </div>
            <form id="deleteAccountForm" class="delete-form">
                <div class="form-group">
                    <label for="deletePasswordInput" class="form-label">
                        <span class="label-icon">🔒</span>
                        Confirma tu contraseña para continuar
                    </label>
                    <div class="password-input-container">
                        <input type="password" id="deletePasswordInput" name="password" 
                               class="form-input" required 
                               placeholder="Ingresa tu contraseña">
                        <button type="button" class="password-toggle" data-target="deletePasswordInput">
                            👁️
                        </button>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="cancelAccountDelete">
                <span class="btn-icon">❌</span>
                Cancelar
            </button>
            <button type="submit" class="btn btn-danger" id="confirmAccountDelete" form="deleteAccountForm">
                <span class="btn-icon">🗑️</span>
                Eliminar Cuenta Permanentemente
            </button>
        </div>
    </div>
</div>

<!-- Modal de Éxito para Upload de Imagen -->
<div id="imageUploadSuccessModal" class="modal" style="display: none;">
    <div class="modal-content modal-small">
        <div class="modal-header success">
            <h3>
                <span class="modal-icon">✅</span>
                ¡Éxito!
            </h3>
        </div>
        <div class="modal-body">
            <p id="imageUploadSuccessMessage">Imagen de perfil actualizada correctamente</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success" id="closeImageUploadSuccess">
                <span class="btn-icon">👍</span>
                Aceptar
            </button>
        </div>
    </div>
</div>
